# Phase 2: 大規模ディレクトリ構造改造計画書

**作成日**: 2025-06-29  
**承認者**: CEO  
**実行予定**: Phase 1完了後  
**リスクレベル**: 高（大規模構造変更）

## 📋 改造の背景と必要性

### 現状の問題点

#### 1. 歴史的遺産による構造の不整合
- **01-06構造**: 初期「薬剤進化図鑑ゲーム」時代の時系列命名
- **現在の実態**: PharmaDx教育プラットフォームの機能別コンテンツ
- **問題**: 命名と内容の不一致による保守性の悪化

#### 2. スケーラビリティの限界
```
現在: 01_stories/ 02_drug_database/ 03_differentiation/ ...
問題: 07, 08, 09... と数字が際限なく増加する設計
解決: 機能別グルーピングによる論理的構造
```

#### 3. 開発フローの曖昧性
- **変換ツール**: ルートに散在（convert_pharmadx.js, config.json）
- **ビルドプロセス**: 手順が不明確
- **メンテナンス**: どこを更新すれば反映されるか不明

### 改造の戦略的価値

#### 1. 長期保守性の確保
- **機能別構造**: stories/, drug_database/, tools/ など直感的
- **拡張性**: 新機能追加時の配置場所が明確
- **チーム開発**: 新メンバーの理解速度向上

#### 2. プロジェクト成熟度の向上
- **プロフェッショナル化**: オープンソースプロジェクト標準構造
- **CI/CD準備**: 自動化ツールとの親和性向上
- **文書化**: 明確な開発フロー確立

## 🎯 Phase 2 実行計画

### 2.1 コンテンツ構造の論理化

#### 移行前構造（現状）
```
pharma_dex/
├── 01_stories/           # 歴史的命名
├── 02_drug_database/     # 歴史的命名
├── 03_differentiation/   # 歴史的命名
├── 04_study_tools/       # 歴史的命名
├── 05_exhibition/        # 歴史的命名
├── 06_resources/         # 歴史的命名
├── convert_pharmadx.js   # ツール散在
├── config.json           # 設定散在
└── ...
```

#### 移行後構造（目標）
```
pharma_dex/
├── content/              # コンテンツ統合ディレクトリ
│   ├── stories/          # 01_stories → 機能名
│   ├── drug_database/    # 02_drug_database → そのまま
│   ├── differentiation/  # 03_differentiation → 機能名
│   ├── study_tools/      # 04_study_tools → 機能名
│   ├── exhibition/       # 05_exhibition → 機能名
│   └── resources/        # 06_resources → 機能名
├── tools/                # 開発ツール統合
│   ├── convert_pharmadx.js
│   ├── config.json
│   └── build.sh          # 新規：ビルドスクリプト
├── docs/                 # 公開Webサイト
├── project-docs/         # プロジェクト管理
└── ...
```

### 2.2 移行手順（段階的実行）

#### Step 1: content/ディレクトリ準備
```bash
mkdir content/
mkdir tools/
```

#### Step 2: 01-06の順次移行
```bash
# 各ディレクトリを機能名で移行
mv 01_stories/ content/stories/
mv 02_drug_database/ content/drug_database/
mv 03_differentiation/ content/differentiation/
mv 04_study_tools/ content/study_tools/
mv 05_exhibition/ content/exhibition/
mv 06_resources/ content/resources/
```

#### Step 3: ツール類の整理
```bash
mv convert_pharmadx.js tools/
mv config.json tools/
```

#### Step 4: 参照パス修正
- `config.json`内のパス更新
- `convert_pharmadx.js`内のパス更新
- 必要に応じて関連スクリプトの修正

#### Step 5: ビルドプロセス標準化
- `tools/build.sh`作成
- 開発フロー文書化
- README.md更新

### 2.3 期待効果

#### 1. 保守性向上（定量的）
- **新メンバー理解時間**: 50%短縮（推定）
- **機能追加時の迷い**: 90%削減
- **パス参照エラー**: 明確化により70%削減

#### 2. プロフェッショナル化
- **GitHub標準構造**: 業界ベストプラクティス準拠
- **オープンソース準備**: 外部貢献者受け入れ可能
- **CI/CD対応**: 自動化パイプライン構築準備

#### 3. 開発効率化
- **ビルドプロセス**: 明確な手順確立
- **コンテンツ更新**: content/ → docs/ フローの確立
- **品質管理**: tools/での統一的品質チェック

## ⚠️ リスクと対策

### 高リスク項目

#### 1. パス参照破綻
**リスク**: config.json, convert_pharmadx.js内のパス不整合
**対策**: 
- 移行前の完全バックアップ
- 段階的移行とテスト
- パス参照のハードコード除去

#### 2. 開発フロー混乱
**リスク**: 移行中の作業場所不明確化
**対策**:
- 移行作業の原子性確保（一気に完了）
- 移行完了後の即座な文書更新
- チーム内での明確な移行タイミング共有

#### 3. 履歴の喪失
**リスク**: git履歴でのファイル追跡困難化
**対策**:
- `git mv`による移行（履歴保持）
- 移行マッピング表の作成・保管
- 重要ファイルの移行前後対応表

### 中リスク項目

#### 1. 外部参照の破綻
**リスク**: 既存文書での01-06参照が古くなる
**対策**: 
- project-docs/内の参照を一括更新
- 移行マッピング表での対応関係明記

#### 2. 作業効率の一時低下
**リスク**: 移行直後の作業場所の迷い
**対策**:
- 新構造の明確な文書化
- よく使う場所のクイックリファレンス作成

## 📊 実行判断基準

### 実行条件（すべて満たす必要）
1. ✅ Phase 1（GitHub Pages対応）の完全成功
2. ✅ 重要ファイルのバックアップ完了
3. ✅ 移行手順のテスト完了（別環境）
4. ✅ チーム内での移行タイミング合意

### 成功基準
1. **構造的成功**: content/, tools/構造の確立
2. **機能的成功**: convert_pharmadx.js正常動作
3. **統合的成功**: content/ → docs/フロー確認
4. **文書的成功**: 新構造での開発フロー文書完成

### 失敗時の対応
1. **即座のロールバック**: git revert機能活用
2. **問題分析**: 失敗原因の特定と記録
3. **再計画**: 問題解決後の再実行計画策定

## 📅 実行スケジュール

### 準備フェーズ（30分）
- バックアップ確認
- 移行手順最終確認
- ツール動作テスト

### 実行フェーズ（60分）
- Step 1-5の順次実行
- 各ステップでの動作確認
- パス参照修正

### 検証フェーズ（30分）
- 全体動作テスト
- 文書更新
- 成功確認

### 文書化フェーズ（30分）
- 新構造の開発フロー文書作成
- README.md更新
- プロジェクト状況更新

## 📈 長期的ビジョン

### Phase 3以降への準備
- **自動化パイプライン**: GitHub Actions対応構造
- **品質管理**: tools/での統一テスト環境
- **スケーラビリティ**: 新機能追加の標準フロー

### 外部展開への準備
- **オープンソース化**: コミュニティ貢献受け入れ準備
- **プロダクト化**: 商用展開時の構造基盤
- **教育利用**: 他大学・機関での利用促進

## 🎯 承認と実行

### 最終承認項目
- [ ] Phase 1の完全成功確認
- [ ] リスク対策の妥当性確認
- [ ] 実行手順の詳細確認
- [ ] 緊急時対応計画の確認

### 実行開始トリガー
**CEO承認後、即座に実行開始**

---

**この大規模改造により、PharmaDxプロジェクトは次の成長段階への基盤を確立します。**