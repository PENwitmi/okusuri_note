# 全薬剤ページ共通 色付きボックス使用最適化実装ルール

作成日時: 2025-07-26  
対象: 全薬剤ページ（/docs/drugs/配下のすべてのHTMLファイル）  
参照: 01-CSS_BACKGROUND_REFORM_REQUIREMENTS.md、04-METFORMIN_OPTIMIZATION.md（実践例）

## 実装ルール

### 1. ボックスクラスの変更基準

#### info-box → simple-boxへの変更
**構造的コンテンツ（メインコンテンツ）**
- 薬理作用の仕組み（流れ図形式）
- 作用機序の解説
- 主作用と副作用の対比説明
- 併用時の相互作用メカニズム
- リスク因子の説明

#### info-box → plain-boxへの変更
**シンプルなリスト形式**
- 年表形式の情報
- 箇条書きの単純な列挙
- 最小限の装飾で十分な内容

#### info-boxを維持するケース
**真の補足情報のみ**
- 「参考」「補足」「エビデンス」と明記されている情報
- 研究データや論文の引用
- メインの説明を補完する副次的な情報

### 2. ⚠️ 色ボックスのネスト構造の修正（最重要）

#### 実際の問題例（metformin.htmlより）
```html
<!-- ❌ 問題：色の中に色がネストされている -->
<div class="info-box">
    <h4>リスク因子が重なると危険</h4>
    <div class="highlight-box">重要な情報</div>
    <div class="info-box">補足情報</div>
</div>
```

#### 修正後
```html
<!-- ✅ 解決：外側を白背景に変更 -->
<div class="simple-box">
    <h4>リスク因子が重なると危険</h4>
    <div class="highlight-box">重要な情報</div>
    <div class="info-box">補足情報</div>
</div>
```

### 3. 維持すべき要素（変更しない）

#### content-itemクラス
- **対比的な情報**（例：コルチゾール vs メトホルミン）
- ユーザー指摘：「対比的な情報は色分けするとわかりやすい」
- content-grid内のcontent-itemは構造要素として必要

### 4. 実装手順

#### Step 1: 現状分析
```bash
# 各色付きボックスの使用数を確認
grep -c "info-box" *.html
grep -c "alert-box" *.html
grep -c "highlight-box" *.html
```

#### Step 2: ネスト構造の特定と修正
1. 色付きボックス内の色付き要素を検索
2. 外側のボックスをsimple-boxに変更
3. 内側の色付きボックスは維持

#### Step 3: 構造的コンテンツの白背景化
1. 各info-boxの内容を確認
2. 流れ図、対比説明、メカニズム解説 → simple-box
3. 年表、単純リスト → plain-box

### 5. 目標とする使用数バランス（metformin.html実績）

#### 適切な使用数の目安
- **info-box**: 10-20個（真の補足情報のみ）
- **alert-box**: 5-15個（重要な警告）
- **highlight-box**: 3-8個（特に重要なポイント）
- **quote-box**: 3-8個（引用、体験談）
- **key-point-box**: 1-3個（処方のコツ）
- **simple-box**: 5-15個（構造化情報）
- **plain-box**: 必要に応じて（シンプルリスト）

### 6. 達成すべき効果

#### 視覚的改善
1. 大きな領域（レベルコンテンツ、content-section）は白背景
2. 中規模の情報ブロックも適度に白背景化
3. 重要な情報は色付きボックスで強調を維持
4. 全体的な「色まみれ」感の解消

#### バランスの重要性
- すべてを白にすると単調になる
- 色付きボックスは適切に使えば効果的
- 読みやすさと強調のバランスを保つ

## 注意事項

### ⚠️ 絶対にやってはいけないこと
1. divタグ自体を削除する
2. content-itemクラスを変更する（対比情報用）
3. content-grid構造を壊す
4. 新しいクラスを作成する

### ✅ 正しい対応
1. クラス名のみを変更
2. ネスト構造の外側を白背景化
3. 既存のcomponents.cssクラスを使用
4. バランスを考慮した使い分け